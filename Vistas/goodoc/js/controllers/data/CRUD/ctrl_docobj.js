function ctrl_docobj($scope,$route,$rootScope,$filter,$timeout,conexion,funcionesutiles){$scope.obtiene_documentos_obj=function(){conexion.docobj_listar({"usuario":$rootScope.usr_global},function(data){if(data.exito){$scope.noPublicados=data.noPublicados;$scope.publicados=data.publicados;}else{ejecutaAlerta(2,'Ocurrió un error: '+data.estatus);}},function(error){ejecutaAlerta(2,'Ocurrió un error al listar los Documentos: '+error.status);});}
$scope.parseUnixToDate=function(fecha){return funcionesutiles.fecalUnixtoDate(fecha);}
$scope.vaciar_datos_en_ckeditor=function(){$timeout(function(){console.info("DOCUMENTO A PONER",$scope.documento)
CKEDITOR.instances["plan_ck"].insertHtml($scope.documento.dscontenido);},1000);}
$scope.obtener_documento_por_id=function(){conexion.docobj_get_x_id({"usuario":$rootScope.usr_global,"documento":JSON.parse($rootScope.edit_docobj)},function(data){$scope.documento=data.documento;},function(error){ejecutaAlerta(2,'Ocurrió un error al obtener el documento: '+error.status);})}
$scope.permiteEditar=false;if($rootScope.edit_docobj){$scope.permiteEditar=true;$scope.obtener_documento_por_id();creaCK('#tb_plantilla');$('.tab-container').easytabs('select','tb_plantilla');$scope.vaciar_datos_en_ckeditor();delete $rootScope.edit_docobj;}
$scope.obtiene_documentos_obj();$scope.guardar_doc=function(publicado){$scope.documento.dscontenido=CKEDITOR.instances['plan_ck'].getData();$scope.documento.usuarioCreoModifico=$scope.usr_global;$scope.documento.ispublicada=publicado;if(publicado)$scope.documento.usuarioPublico=$scope.usr_global;conexion.docobj_guardar({"usuario":$scope.usr_global,"documento":$scope.documento},function(data){if(data.exito){$route.reload()
setTimeout(function(){ejecutaAlerta(1,"Se registró correctamente el documento");},1000)}else{ejecutaAlerta(2,"Ocurrió un error: "+data.estatus)}},function(error){alert("Algo malo paso al guardar el documento: "+error.status);});}
$scope.actualiza_doc=function(publicado){$scope.documento.dscontenido=CKEDITOR.instances['plan_ck'].getData();$scope.documento.usuarioCreoModifico=$scope.usr_global;$scope.documento.ispublicada=publicado;if(publicado)$scope.documento.usuarioPublico=$scope.usr_global;conexion.docobj_actualizar({"usuario":$scope.usr_global,"documento":$scope.documento},function(data){if(data.exito){$route.reload()
setTimeout(function(){ejecutaAlerta(1,"Se registró correctamente el documento");},1000)}else{ejecutaAlerta(2,"Ocurrió un error: "+data.estatus)}},function(error){alert("Algo malo paso al guardar el documento: "+error.status);});}}