function ctrl_escritura_doc_obj($scope,$rootScope,conexion_app,conexion,catalogos,funcionesutiles){$scope.popLateral=function(url_cargar,columnas,status){funcionesutiles.popLateral(url_cargar,columnas,status);if(!status){$scope.resetCampos();}}
$scope.resetCampos=function(){delete $rootScope.actos;delete $scope.tmp_doc;$("#visor_previa").html("")}
conexion_app.get_doc_obj_combo({"usuario":$scope.usr_global},function(data){if(data.exito){$scope.lista_doc_obj=data.listaCombo;}else{ejecutaAlerta(2,"Ocurrió un error: "+data.estatus);}},function(error){alert("Algo malo ocurrió al obtener los documentos objeto: "+error.status);})
if($rootScope.actos){$scope.actos=$rootScope.actos;}
$scope.obten_doc_obj_completo=function(){conexion_app.get_doc_obj_x_id({"documento":{"id":{"iddocobjeto":$scope.sel_doc_obj.id,"version":$scope.sel_doc_obj.version}},"usuario":$scope.usr_global},function(data){if(data.exito){$scope.tmp_doc=data.documento;$("#visor_previa").html($scope.tmp_doc.dscontenido);}
else{ejecutaAlerta(2,"Ocurrió un error: "+data.estatus);}},function(error){alert("Algo malo ocurrió un error al obtener el documento por id: "+error.status);})}
$scope.transforma_txt=function(){if($scope.sel_acto&&$scope.sel_doc_obj){conexion_app.get_doc_obj_llenaPlantilla({"documento":{"id":{"iddocobjeto":$scope.sel_doc_obj.id,"version":$scope.sel_doc_obj.version}},"acto":{"idacto":$scope.sel_acto.idacto},"usuario":$scope.usr_global},function(data){if(data.exito){CKEDITOR.instances["plan_ck"].insertHtml(data.txtDocumento);console.info(CKEDITOR.instances["plan_ck"]);$scope.popLateral('',2,false);}
else{ejecutaAlerta(2,"Ocurrió un error: "+data.estatus);}},function(error){alert("Algo malo ocurrió un error al insertar el documento: "+error.status);});}else{alert("Antes de continuar debe seleccionar algún campo");}}}